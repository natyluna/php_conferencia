
if($_POST['registro'] == 'nuevo') {
    /* die(json_encode($_POST)); *///para comprobar q se envien los datos
    


if($_POST['registro'] == 'actualizar') {
  
    //como ya tengo los datos, PARA ACTUALIZAR
    try{
        if (empty($_POST['password'])) {
            $stmt = $conn->prepare("UPDATE admins SET usuario=?, nombre=?, editado= NOW()  WHERE id_admin=?");
            $stmt->bind_param("ssi", $usuario, $nombre, $id_registro);
        } else {
            //opciones hash
            $opciones = array(
                'cost' => 12
            );
            $hash_password = password_hash($password, PASSWORD_BCRYPT, $opciones);
            $stmt = $conn->prepare('UPDATE admins SET usuario = ?, nombre=?, password=? ,editado= NOW() WHERE id_admin= ? ');
            $stmt->bind_param("sssi", $usuario, $nombre, $hash_password, $id_registro);
        }
         
        $stmt->execute();
        if($stmt->affected_rows){
            $respuesta= array(
                'respuesta'=> 'exito',
                'id_actualizado'=> $stmt->insert_id
            );
        }else{
            $respuesta= array(
                'respuesta'=>'error'
            );
        }
        $stmt->close();
        $conn->close();
    } catch (Exception $e){
        $respuesta= array(
            'respuesta' => $e->getMessage()
        );
    }
    die(json_encode($respuesta));
}


if($_POST['registro'] == 'eliminar') {
    $id_borrar= $_POST['id'];

    try{
        $stmt= $conn->prepare('DELETE FROM admins WHERE id_admin = ? ');
        $stmt->bind_param('i', $id_borrar);
        $stmt->execute();
        if($stmt->affected_rows){
            $respuesta= array(
                'respuesta'=> 'exito',
                'id_eliminado'=> $id_borrar
            );
        }else{
            $respuesta= array(
                'respuesta'=>'error'
            );
        }
    }catch(Exception $e){
        //$resultado= array(
            $respuesta=array(
            'respuesta'=>$e->getMessage()
        );
    }
    die(json_encode($respuesta));
}

